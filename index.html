<script>
    const PASSWORD = "Talha"; // Set your password here
    const loginForm = document.getElementById('login-form');
    const passwordInput = document.getElementById('password');
    const submitBtn = document.getElementById('submit-btn');
    const videoContainer = document.querySelector('.video-container');
    const videoPlayer = document.getElementById('my-video');
    const qualityControls = document.querySelector('.quality-controls');
    const qualityOptions = document.getElementById('quality-options');
    const videoSrc = "https://flipfit-cdn.akamaized.net/flip_hls/662aae7a42cd740019b91dec-3e114f/video_h1.m3u8";

    submitBtn.addEventListener('click', () => {
        const enteredPassword = passwordInput.value.trim(); // Trimmed whitespace
        if (enteredPassword === PASSWORD) {
            loginForm.style.display = 'none';
            videoPlayer.style.display = 'block';
            qualityControls.style.display = 'block';

            if (Hls.isSupported()) {
                var hls = new Hls();
                hls.loadSource(videoSrc);
                hls.attachMedia(videoPlayer);
                hls.on(Hls.Events.MANIFEST_PARSED, function() {
                    videoPlayer.play();
                    populateQualityOptions(hls);
                });

                hls.on(Hls.Events.LEVEL_SWITCHED, function(event, data) {
                    const activeQuality = hls.levels[data.level];
                    qualityOptions.value = activeQuality.height;
                });

                qualityOptions.addEventListener('change', function() {
                    const selectedHeight = parseInt(this.value);
                    const selectedLevel = hls.levels.findIndex(level => level.height === selectedHeight);
                    hls.currentLevel = selectedLevel;
                });

            } else if (videoPlayer.canPlayType('application/vnd.apple.mpegurl')) {
                videoPlayer.src = videoSrc;
                videoPlayer.addEventListener('loadedmetadata', function() {
                    videoPlayer.play();
                });
            }
        } else {
            alert('Incorrect password. Please try again.');
        }
    });

    function populateQualityOptions(hls) {
        while (qualityOptions.firstChild) {
            qualityOptions.removeChild(qualityOptions.firstChild);
        }

        hls.levels.forEach((level, index) => {
            const option = document.createElement('option');
            option.value = level.height;
            option.textContent = `${level.height}p`;
            qualityOptions.appendChild(option);
        });

        // Select the initial quality level
        const activeQuality = hls.levels[hls.currentLevel];
        qualityOptions.value = activeQuality.height;
    }
</script>
